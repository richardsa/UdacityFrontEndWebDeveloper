var Client;(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{formSubmit:()=>d,getCity:()=>u,getImage:()=>p,getTrip:()=>S,getWeather:()=>y,setTrip:()=>w});const o=document.getElementById("heading"),n=document.getElementById("temp"),a=document.getElementById("search-form"),r=document.getElementById("location-img"),l=document.getElementById("weather"),c=document.getElementById("error-message");let i=new Date;i=i.setDate(i.getDate()+7);let s="";function d(t){t.preventDefault(),c.style.display="none";const e=document.getElementById("city").value;let o=document.getElementById("trip-date").value,n=new Date(o);s=n>=i?"Predicted":"Current",Client.getCity(e).then((function(t){if(0==t.totalResultsCount)return void(c.style.display="block");const e=t.geonames[0],n=e.name,a=e.adminCode1,r=e.countryCode,l=e.lat,i=e.lng;Client.getWeather(l,i,s,o).then((function(t){const e=t.temp,o=t.weather.description,l=t.weather.icon;Client.getImage(n).then((function(t){let c="https://placedog.net/500";t.webformatURL&&(c=t.webformatURL),g("/add",{city:n,state:a,country:r,image:c,temp:e,description:o,icon:l,timeFrame:s}).then((function(){m("all")}))}))}))}))}const g=async(t,e)=>{const o=await fetch(t,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});try{return await o.json()}catch(t){console.log("Something went wrong!",t)}},m=async t=>{const e=await fetch(t);try{const t=await e.json(),a=t.data.city,c=t.data.state,i=t.data.country,s=t.data.image,d=t.data.description,g=t.data.temp,m=(t.data.icon,t.data.timeFrame);o.innerHTML=`${m} Weather for ${a}, ${c}, ${i}`,n.innerHTML=`Temperature: ${g} &#8457;`,r.innerHTML=`<img src="${s}" class="results-img" />`,l.innerHTML=d,Client.setTrip()}catch(t){console.log("error",t)}};a.addEventListener("submit",d);const u=async t=>{let e=`http://localhost:3000/cities/${t}`;const o=await fetch(e);try{const t=await o.json();return console.log(t),t}catch(t){console.log("error",t)}},y=async(t,e,o,n)=>{let a;if("Predicted"==o){let o=new Date(n),r=new Date(n);console.log("end date"+r),r=r.setUTCDate(r.getUTCDate()+1),console.log("end date"+r),console.log("start date "+o),o=h(o),r=h(r),a=`http://localhost:3000/avg-weather/?lat=${t}&lon=${e}&start_day=${o}&end_day=${r}`}else a=`http://localhost:3000/weather/?lat=${t}&lon=${e}`;const r=await fetch(a);try{const t=await r.json();return console.log(t.data[0]),t.data[0]}catch(t){console.log("error",t)}};function h(t){return console.log("date formatted"+t),(t=(t=new Date(t)).toISOString().split("T")[0]).slice(5)}const p=async t=>{let e=`http://localhost:3000/images/${t}`;const o=await fetch(e);try{const t=await o.json();return console.log(t),t}catch(t){console.log("error",t)}},f=document.getElementById("entryHolder");function w(){localStorage?(console.log("trip"),JSON.stringify(f),localStorage.setItem("trip-info",f.outerHTML)):console.log("Error: you don't have localStorage!")}function S(){console.log("running"),null!==localStorage.getItem("trip-info")&&(console.log(localStorage["trip-info"]),f.outerHTML=localStorage["trip-info"])}Client=e})();